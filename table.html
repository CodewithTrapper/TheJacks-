<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;500;600;700;800;900&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="Styles/style.css">
    <title>The Jacks' Hotel - Table Booking</title>
</head>
<body>
    <div class="booking-container">
        <h1>Book a Table at The Jacks' Hotel</h1>
        <p>Fill in your details to reserve a table at our restaurant.</p>

        <form id="tableBookingForm">
            <div class="form-group">
                <label for="fullName">Full Name:</label>
                <input type="text" id="fullName" name="fullName" placeholder="Your Name" required>
            </div>

            <div class="form-group">
                <label for="emailAddress">Email:</label>
                <input type="email" id="emailAddress" name="emailAddress" placeholder="Your Email" required>
            </div>

            <div class="form-group">
                <label for="phoneNumber">Phone Number:</label>
                <input type="tel" id="phoneNumber" name="phoneNumber" placeholder="eg. +254 xxx xxxxx" required>
            </div>

            <div class="form-group">
                <label for="bookingDate">Date:</label>
                <input type="date" id="bookingDate" name="bookingDate" required>
            </div>

            <div class="form-group">
                <label for="bookingTime">Time:</label>
                <input type="time" id="bookingTime" name="bookingTime" required>
            </div>

            <div class="form-group">
                <label for="guests">Number of Guests:</label>
                <input type="number" id="guests" name="guests" min="1" max="20" required>
            </div>

            <div class="form-group">
                <label for="specialRequests">Special Requests:</label>
                <textarea id="specialRequests" name="specialRequests" placeholder="Any special requests?"></textarea>
            </div>

            <button type="submit" class="booktblnow">Book Table</button>
        </form>

        <div class="success-message" id="successMessage">Booking submitted successfully!</div>
        <div class="error-message" id="errorMessage">Something went wrong. Please try again.</div>
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", () => {
            const bookingForm = document.getElementById("tableBookingForm");
            const successMessage = document.getElementById("successMessage");
            const errorMessage = document.getElementById("errorMessage");

            bookingForm.addEventListener("submit", async (e) => {
                e.preventDefault();


                const bookingData = {
                    fullName: document.getElementById("fullName").value.trim(),
                    emailAddress: document.getElementById("emailAddress").value.trim(),
                    phoneNumber: document.getElementById("phoneNumber").value.trim(),
                    bookingDate: document.getElementById("bookingDate").value,
                    bookingTime: document.getElementById("bookingTime").value,
                    guests: parseInt(document.getElementById("guests").value, 10),
                    specialRequests: document.getElementById("specialRequests").value.trim()
                };


                if (!bookingData.fullName || !bookingData.emailAddress || !bookingData.phoneNumber) {
                    errorMessage.textContent = "Please fill in all required fields.";
                    errorMessage.style.display = "block";
                    successMessage.style.display = "none";
                    return;
                }

                if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(bookingData.emailAddress)) {
                    errorMessage.textContent = "Please enter a valid email address.";
                    errorMessage.style.display = "block";
                    successMessage.style.display = "none";
                    return;
                }

                try {
                    const response = await fetch("/book-table", {
                        method: "POST",
                        headers: { "Content-Type": "application/json" },
                        body: JSON.stringify(bookingData)
                    });

                    const data = await response.json();

                    if (response.ok) {
                        successMessage.textContent = data.message || "Booking submitted successfully!";
                        successMessage.style.display = "block";
                        errorMessage.style.display = "none";
                        bookingForm.reset();
                    } else {
                        errorMessage.textContent = data.message || "Something went wrong. Please try again.";
                        errorMessage.style.display = "block";
                        successMessage.style.display = "none";
                    }

                } catch (err) {
                    console.error(err);
                    errorMessage.textContent = "Something went wrong. Please try again.";
                    errorMessage.style.display = "block";
                    successMessage.style.display = "none";
                }
            });
        });
    </script>

</body>
</html>